metadata:
  name: onapsisExecuteScan
  description: Execute a scan with Onapsis Control
  longDescription: This step executes a scan with Onapsis Control.
spec:
  inputs:
    secrets:
      - name: onapsisTokenCredentialsId
        type: jenkins
        description: "Jenkins 'Secret text' credentials ID containing the token used to authenticate with Onapsis Control Scan Service"
        mandatory: true
    params:
      - name: scanServiceUrl
        type: string
        description: URL of the scan service
        mandatory: true
        scope:
          - PARAMETERS
          - STAGES
          - STEPS
      - name: accessToken
        type: string
        description: "Token used to authenticate with the Control Scan Service"
        scope:
          - PARAMETERS
          - STAGES
          - STEPS
        secret: true
        resourceRef:
          - name: onapsisTokenCredentialsId
            type: secret
